import time
from statistics import mean, median

data = [
[1,50.1999866669333],
[2,50.3998933418663],
[3,50.5996400647944],
[4,50.7991469396917],
[5,50.9983341664682],
[6,51.1971220728891],
[7,51.3954311464423],
[8,51.5931820661424],
[9,51.7902957342582],
[10,51.9866933079506],
[11,52.1822962308086],
[12,52.3770262642713],
[13,52.5708055189215],
[14,52.7635564856411],
[15,52.9552020666133],
[16,53.1456656061611],
[17,53.3348709214081],
[18,53.5227423327509],
[19,53.7092046941298],
[20,53.8941834230865],
[21,54.0776045305957],
[22,54.25939465066],
[23,54.4394810696552],
[24,54.6177917554148],
[25,54.794255386042],
[26,54.9688013784373],
[27,55.1413599165311],
[28,55.3118619792088],
[29,55.4802393679187],
[30,55.6464247339503],
[31,55.810351605373],
[32,55.9719544136239],
[33,56.1311685197343],
[34,56.2879302401846],
[35,56.4421768723769],
[36,56.5938467197147],
[37,56.7428791162814],
[38,56.8892144511055],
[39,57.0327941920041],
[40,57.1735609089952],
[41,57.3114582972689],
[42,57.4464311997085],
[43,57.5784256289527],
[44,57.7073887889897],
[45,57.8332690962748],
[46,57.9560162003636],
[47,58.0755810040511],
[48,58.1919156830099],
[49,58.3049737049197],
[50,58.4147098480789],
[51,58.5210802194936],
[52,58.6240422724333],
[53,58.7235548234498],
[54,58.8195780688494],
[55,58.9120736006143],
[56,59.001004421765],
[57,59.0863349611588],
[58,59.1680310877176],
[59,59.2460601240802],
[60,59.3203908596722],
[61,59.3909935631906],
[62,59.4578399944953],
[63,59.5209034159051],
[64,59.5801586028922],
[65,59.6355818541719],
[66,59.6871510011826],
[67,59.7348454169531],
[68,59.7786460243531],
[69,59.8185353037236],
[70,59.8544972998846],
[71,59.8865176285172],
[72,59.9145834819168],
[73,59.9386836341164],
[74,59.9588084453764],
[75,59.9749498660405],
[76,59.9871014397558],
[77,59.9952583060547],
[78,59.9994172022996],
[79,59.9995764649874],
[80,59.995736030415],
[81,59.9878974347052],
[82,59.9760638131917],
[83,59.9602398991653],
[84,59.9404320219807],
[85,59.9166481045246],
[86,59.888897660047],
[87,59.8571917883555],
[88,59.8215431713761],
[89,59.7819660680804],
[90,59.7384763087819],
[91,59.6910912888045],
[92,59.6398299615244],
[93,59.5847128307891],
[94,59.5257619427159],
[95,59.4630008768741],
[96,59.3964547368532],
[97,59.326150140222],
[98,59.2521152078816],
[99,59.174379552818],
[100,59.0929742682568],
[101,59.0079319152262],
[102,58.9192865095338],
[103,58.8270735081597],
[104,58.7313297950751],
[105,58.6320936664887],
[106,58.5294048155287],
[107,58.4233043163664],
[108,58.3138346077868],
[109,58.2010394762137],
[110,58.0849640381959],
[111,57.9656547223608],
[112,57.8431592508442],
[113,57.7175266202012],
[114,57.5888070818092],
[115,57.4570521217672],
[116,57.3223144403025],
[117,57.1846479306912],
[118,57.0441076577017],
[119,56.9007498355693],
[120,56.7546318055115],
[121,56.605812012792],
[122,56.4543499833437],
[123,56.3003062999589],
[124,56.1437425780571],
[125,55.9847214410395],
[126,55.8233064952408],
[127,55.659562304487],
[128,55.4935543642712],
[129,55.3253490755562],
[130,55.1550137182146],
[131,54.9826164241183],
[132,54.8082261498864],
[133,54.6319126493034],
[134,54.4537464454187],
[135,54.2737988023383],
[136,54.0921416967201],
[137,53.9088477889845],
[138,53.7239903942505],
[139,53.5376434530114],
[140,53.349881501559],
[141,53.1607796421705],
[142,52.9704135130683],
[143,52.7788592581658],
[144,52.5861934966111],
[145,52.3924932921398],
[146,52.1978361222511],
[147,52.0022998472177],
[148,51.8059626789423],
[149,51.6089031496745],
[150,51.4112000805986],
[151,51.2129325503063],
[152,51.014179863166],
[153,50.8150215176026],
[154,50.6155371742991],
[155,50.4158066243329],
[156,50.2159097572609],
[157,50.0159265291648],
[158,49.8159369306694],
[159,49.6160209549476],
[160,49.4162585657242],
[161,49.2167296652913],
[162,49.0175140625489],
[163,48.8186914410818],
[164,48.6203413272877],
[165,48.4225430585675],
[166,48.2253757515914],
[167,48.0289182706533],
[168,47.8332491961262],
[169,47.638446793031],
[170,47.4445889797316],
[171,47.2517532967687],
[172,47.0600168758443],
[173,46.8694564089703],
[174,46.6801481177926],
[175,46.4921677231038],
[176,46.3055904145552],
[177,46.1204908205826],
[178,45.9369429785558],
[179,45.7550203051641],
[180,45.5747955670514],
[181,45.39634085171],
[182,45.2197275386465],
[183,45.0450262708315],
[184,44.8723069264427],
[185,44.701638590915],
[186,44.5330895293071],
[187,44.3667271589963],
[188,44.2026180227125],
[189,44.0408277619223],
[190,43.8814210905728],
[191,43.724461769207],
[192,43.5700125794609],
[193,43.4181352989509],
[194,43.2688906765643],
[195,43.1223384081602],
[196,42.9785371126919],
[197,42.8375443087602],
[198,42.699416391607],
[199,42.5642086105572],
[200,42.4319750469207],
[201,42.3027685923597],
[202,42.1766409277334],
[203,42.053642502426],
[204,41.9338225141675],
[205,41.8172288893558],
[206,41.7039082638862],
[207,41.593905964498],
[208,41.4872659906442],
[209,41.3840309968926],
[210,41.2842422758641],
[211,41.1879397417167],
[212,41.0951619141801],
[213,41.0059459031482],
[214,40.9203273938359],
[215,40.8383406325054],
[216,40.7600184127681],
[217,40.6853920624675],
[218,40.6144914311489],
[219,40.5473448781193],
[220,40.4839792611048],
[221,40.4244199255072],
[222,40.3686906942668],
[223,40.3168138583329],
[224,40.2688101677482],
[225,40.224698823349],
[226,40.1844974690848],
[227,40.1482221849614],
[228,40.1158874806087],
[229,40.0875062894773],
[230,40.0630899636653],
[231,40.0426482693775],
[232,40.026189383019],
[233,40.013719887925],
[234,40.0052447717271],
[235,40.0007674243589],
[236,40.0002896366997],
[237,40.0038115998581],
[238,40.0113319050958],
[239,40.022847544391],
[240,40.0383539116415],
[241,40.0578448045072],
[242,40.0813124268908],
[243,40.1087473920563],
[244,40.1401387263833],
[245,40.1754738737566],
[246,40.2147387005886],
[247,40.2579175014719],
[248,40.3049930054619],
[249,40.3559463829847],
[250,40.4107572533686],
[251,40.4694036929963],
[252,40.5318622440739],
[253,40.5981079240137],
[254,40.668114235427],
[255,40.7418531767226],
[256,40.8192952533073],
[257,40.9004094893828],
[258,40.9851634403364],
[259,41.0735232057176],
[260,41.1654534427984],
[261,41.2609173807097],
[262,41.3598768351492],
[263,41.4622922236545],
[264,41.5681225814358],
[265,41.6773255777609],
[266,41.7898575328875],
[267,41.9056734355338],
[268,42.0247269608829],
[269,42.1469704891121],
[270,42.2723551244401],
[271,42.4008307146843],
[272,42.5323458713218],
[273,42.6668479900434],
[274,42.8042832717949],
[275,42.944596744296],
[276,43.0877322840287],
[277,43.2336326386854],
[278,43.3822394500696],
[279,43.5334932774381],
[280,43.6873336212767],
[281,43.8436989474991],
[282,44.0025267120595],
[283,44.1637533859699],
[284,44.3273144807103],
[285,44.4931445740236],
[286,44.6611773360835],
[287,44.8313455560257],
[288,45.0035811688309],
[289,45.1778152825506],
[290,45.3539782058624],
[291,45.5319994759457],
[292,45.711807886666],
[293,45.8933315170565],
[294,46.0764977600854],
[295,46.2612333516976],
[296,46.4474644001195],
[297,46.6351164154149],
[298,46.8241143392796],
[299,47.014382575064],
[300,47.2058450180107],
[301,47.3984250856953],
[302,47.5920457486584],
[303,47.7866295612164],
[304,47.9820986924387],
[305,48.178374957279],
[306,48.3753798478484],
[307,48.5730345648174],
[308,48.7712600489345],
[309,48.969977012649],
[310,49.169105971825],
[311,49.3685672775338],
[312,49.5682811479127],
[313,49.7681677000762],
[314,49.9681469820686],
[315,50.1681390048434],
[316,50.3680637742582],
[317,50.5678413230707],
[318,50.7673917429251],
[319,50.9666352163141],
[320,51.1654920485049],
[321,51.3638826994159],
[322,51.5617278154321],
[323,51.7589482611448],
[324,51.9554651510054],
[325,52.1511998808781],
[326,52.3460741594808],
[327,52.5400100397002],
[328,52.7329299497701],
[329,52.9247567242986],
[330,53.1154136351337],
[331,53.3048244220531],
[332,53.4929133232673],
[333,53.6796051057238],
[334,53.8648250951987],
[335,54.0484992061659],
[336,54.2305539714299],
[337,54.410916571512],
[338,54.5895148637769],
[339,54.7662774112889],
[340,54.941133511386],
[341,55.1140132239595],
[342,55.2848473994293],
[343,55.453567706403],
[344,55.6201066590074],
[345,55.784397643882],
[346,55.9463749468232],
[347,56.1059737790697],
[348,56.2631303032165],
[349,56.4177816587493],
[350,56.5698659871878],
[351,56.7193224568286],
[352,56.8660912870763],
[353,57.0101137723559],
[354,57.1513323055935],
[355,57.2896904012587],
[356,57.425132717958],
[357,57.5576050805705],
[358,57.6870545019175],
[359,57.8134292039565],
[360,57.9366786384915],
[361,58.0567535073921],
[362,58.1736057823117],
[363,58.2871887238983],
[364,58.3974569004898],
[365,58.5043662062856],
[366,58.607873878989],
[367,58.7079385169109],
[368,58.8045200955303],
[369,58.8975799835036],
[370,58.9870809581162],
[371,59.0729872201718],
[372,59.1552644083109],
[373,59.2338796127551],
[374,59.3088013884711],
[375,59.3799997677473],
[376,59.4474462721815],
[377,59.511113924071],
[378,59.5709772572041],
[379,59.6270123270457],
[380,59.6791967203148],
[381,59.7275095639501],
[382,59.7719315334582],
[383,59.8124448606436],
[384,59.8490333407156],
[385,59.88168233877],
[386,59.9103787956429],
[387,59.9351112331341],
[388,59.9558697585985],
[389,59.9726460689026],
[390,59.985433453746],
[391,59.9942267983452],
[392,59.9990225854797],
[393,59.9998188968985],
[394,59.9966154140877],
[395,59.9894134183977],
[396,59.9782157905307],
[397,59.9630270093886],
[398,59.9438531502814],
[399,59.9207018824969],
[400,59.8935824662338],
[401,59.8625057488968],
[402,59.8274841607586],
[403,59.7885317099874],
[404,59.7456639770443],
[405,59.6988981084508],
[406,59.6482528099309],
[407,59.5937483389286],
[408,59.5354064965057],
[409,59.4732506186213],
[410,59.4073055667977],
[411,59.3375977181765],
[412,59.2641549549676],
[413,59.1870066532972],
[414,59.1061836714573],
[415,59.0217183375629],
[416,58.9336444366215],
[417,58.8419971970191],
[418,58.7468132764296],
[419,58.6481307471522],
[420,58.5459890808828],
[421,58.440429132926],
[422,58.3314931258536],
[423,58.219224632616],
[424,58.1036685591135],
[425,57.9848711262349],
[426,57.8628798513692],
[427,57.7377435294001],
[428,57.6095122131877],
[429,57.4782371935489],
[430,57.3439709787411],
[431,57.2067672734601],
[432,57.0666809573587],
[433,56.9237680630956],
[434,56.7780857539228],
[435,56.6296923008218],
[436,56.4786470591951],
[437,56.3250104451256],
[438,56.1688439112104],
[439,56.0102099219809],
[440,55.8491719289176],
[441,55.6857943450707],
[442,55.5201425192953],
[443,55.3522827101131],
[444,55.1822820592097],
[445,55.0102085645788],
[446,54.8361310533239],
[447,54.6601191541287],
[448,54.4822432694058],
[449,54.3025745471376],
[450,54.1211848524175],
[451,53.9381467387048],
[452,53.7535334188046],
[453,53.5674187355832],
[454,53.3798771324326],
[455,53.1909836234935],
[456,53.0008137636508],
[457,52.809443618313],
[458,52.6169497329866],
[459,52.4234091026592],
[460,52.2288991410024],
[461,52.0334976494075],
[462,51.8372827858658],
[463,51.6403330337065],
[464,51.4427271702045],
[465,51.2445442350706],
[466,51.0458634988363],
[467,50.8467644311472],
[468,50.6473266689756],
[469,50.4476299847674],
[470,50.2477542545335],
[471,50.0477794259012],
[472,49.8477854861356],
[473,49.6478524301461],
[474,49.4480602284892],
[475,49.2484887953819],
[476,49.0492179567363],
[477,48.8503274182312],
[478,48.65189673343],
[479,48.454005271961],
[480,48.2567321877702],
[481,48.060156387461],
[482,47.8643564987326],
[483,47.6694108389298],
[484,47.4753973837174],
[485,47.2823937358905],
[486,47.090477094335],
[487,46.8997242231487],
[488,46.7102114209367],
[489,46.522014490293],
[490,46.3352087074807],
[491,46.1498687923221],
[492,45.9660688783123],
[493,45.783882482966],
[494,45.6033824784125],
[495,45.4246410622467],
[496,45.2477297286522],
[497,45.0727192398034],
[498,44.8996795975624],
[499,44.7286800154791],
[500,44.5597888911063],
[501,44.3930737786418],
[502,44.2286013619079],
[503,44.0664374276782],
[504,43.9066468393643],
[505,43.7492935110711],
[506,43.5944403820319],
[507,43.4421493914334],
[508,43.2924814536416],
[509,43.1454964338359],
[510,43.0012531240645],
[511,42.8598092197281],
[512,42.7212212965026],
[513,42.5855447877093],
[514,42.4528339621429],
[515,42.3231419023641],
[516,42.1965204834676],
[517,42.0730203523328],
[518,41.9526909073653],
[519,41.8355802787388],
[520,41.7217353091434],
[521,41.611201535049],
[522,41.5040231684913],
[523,41.4002430793881],
[524,41.2999027783912],
[525,41.2030424002833],
[526,41.109700687924],
[527,41.0199149767538],
[528,40.93372117986],
[529,40.8511537736122],
[530,40.7722457838719],
[531,40.697028772783],
[532,40.625532826147],
[533,40.5577865413894],
[534,40.4938170161207],
[535,40.4336498372981],
[536,40.3773090709909],
[537,40.3248172527546],
[538,40.2761953786164],
[539,40.2314628966778],
[540,40.190637699335],
[541,40.1537361161228],
[542,40.1207729071824],
[543,40.0917612573578],
[544,40.0667127709222],
[545,40.0456374669362],
[546,40.0285437752403],
[547,40.0154385330834],
[548,40.0063269823875],
[549,40.0012127676514],
[550,40.0000979344929],
[551,40.0029829288304],
[552,40.0098665967045],
[553,40.02074618474],
[554,40.0356173412466],
[555,40.0544741179601],
[556,40.0773089724211],
[557,40.1041127709924],
[558,40.1348747925118],
[559,40.1695827325811],
[560,40.2082227084868],
[561,40.2507792647538],
[562,40.2972353793271],
[563,40.3475724703801],
[564,40.4017704037477],
[565,40.4598075009791],
[566,40.5216605480092],
[567,40.5873048044439],
[568,40.656714013456],
[569,40.7298604122872],
[570,40.8067147433532],
[571,40.8872462659464],
[572,40.9714227685315],
[573,41.0592105816297],
[574,41.1505745912863],
[575,41.2454782531157],
[576,41.3438836069184],
[577,41.445751291865],
[578,41.5510405622397],
[579,41.6597093037382],
[580,41.7717140503129],
[581,41.8870100015584],
[582,42.0055510406315],
[583,42.1272897526971],
[584,42.2521774438936],
[585,42.3801641608096],
[586,42.5111987104649],
[587,42.6452286807865],
[588,42.7822004615736],
[589,42.92205926594],
[590,43.0647491522287],
[591,43.2102130463878],
[592,43.358392764799],
[593,43.5092290375507],
[594,43.662661532145],
[595,43.8186288776296],
[596,43.977068689146],
[597,44.1379175928821],
[598,44.301111251421],
[599,44.4665843894752],
[600,44.6342708199956],
[601,44.804103470646],
[602,44.9760144106304],
[603,45.1499348778649],
[604,45.3257953064817],
[605,45.5035253546539],
[606,45.6830539327321],
[607,45.8643092316787],
[608,46.0472187517909],
[609,46.2317093316992],
[610,46.4177071776317],
[611,46.6051378929298],
[612,46.7939265078066],
[613,46.9839975093331],
[614,47.1752748716431],
[615,47.3676820863419],
[616,47.5611421931091],
[617,47.7555778104814],
[618,47.9509111668042],
[619,48.1470641313396],
[620,48.3439582455169],
[621,48.5415147543157],
[622,48.7396546377666],
[623,48.938298642558],
[624,49.1373673137365],
[625,49.3367810264879],
[626,49.536460017986],
[627,49.7363244192964],
[628,49.9362942873234],
[629,50.1362896367861],
[630,50.3362304722113],
[631,50.5360368199306],
[632,50.735628760069],
[633,50.9349264585116],
[634,51.1338501988364],
[635,51.3323204141994],
[636,51.5302577191607],
[637,51.7275829414376],
[638,51.924217153572],
[639,52.1200817045009],
[640,52.3150982510153],
[641,52.5091887890969],
[642,52.7022756851183],
[643,52.8942817068955],
[644,53.0851300545799],
[645,53.2747443913769],
[646,53.46304887408],
[647,53.6499681834069],
[648,53.8354275541261],
[649,54.0193528049619],
[650,54.2016703682664],
[651,54.3823073194451],
[652,54.561191406126],
[653,54.7382510770595],
[654,54.9134155107381],
[655,55.0866146437237],
[656,55.2577791986724],
[657,55.4268407120445],
[658,55.5937315614886],
[659,55.7583849928903],
[660,55.9207351470722],
[661,56.0807170861374],
[662,56.2382668194433],
[663,56.3933213291971],
[664,56.5458185956625],
[665,56.695697621966],
[666,56.8428984584955],
[667,56.987362226879],
[668,57.1290311435353],
[669,57.2678485427868],
[670,57.4037588995244],
[671,57.5367078514178],
[672,57.6666422206586],
[673,57.7935100352318],
[674,57.9172605497029],
[675,58.0378442655162],
[676,58.1552129507931],
[677,58.2693196596244],
[678,58.380118750848],
[679,58.4875659063047],
[680,58.5916181485649],
[681,58.6922338581191],
[682,58.7893727900249],
[683,58.8829960900048],
[684,58.973066309987],
[685,59.0595474230846],
[686,59.1424048380052],
[687,59.2216054128878],
[688,59.2971174685583],
[689,59.3689108012013],
[690,59.436956694441],
[691,59.5012279308273],
[692,59.5616988027226],
[693,59.6183451225845],
[694,59.6711442326402],
[695,59.7200750139497],
[696,59.7651178948529],
[697,59.806254858798],
[698,59.843469451548],
[699,59.8767467877618],
[700,59.9060735569487],
[701,59.931438028792],
[702,59.9528300578412],
[703,59.97024108757],
[704,59.9836641537984],
[705,59.9930938874791],
[706,59.9985265168443],
[707,59.9999598689147],
[708,59.9973933703685],
[709,59.990828047771],
[710,59.9802665271636],
[711,59.9657130330138],
[712,59.9471733865252],
[713,59.9246550033092],
[714,59.8981668904188],
[715,59.8677196427461],
[716,59.8333254387841],
[717,59.7949980357559],
[718,59.7527527641116],
[719,59.7066065213966],
[720,59.6565777654927],
[721,59.6026865072353],
[722,59.5449543024092],
[723,59.4834042431264],
[724,59.4180609485901],
[725,59.3489505552468],
[726,59.2761007063324],
[727,59.1995405408152],
[728,59.1193006817406],
[729,59.0354132239823],
[730,58.947911721405],
[731,58.856831173443],
[732,58.7622080111012],
[733,58.6640800823828],
[734,58.562486637151],
[735,58.4574683114293],
[736,58.3490671111478],
[737,58.2373263953412],
[738,58.122290858806],
[739,58.0040065142231],
[740,57.8825206737531],
[741,57.7578819301125],
[742,57.630140137137],
[743,57.4993463898404],
[744,57.3655530039778],
[745,57.2288134951197],
[746,57.0891825572465],
[747,56.9467160408715],
[748,56.8014709307018],
[749,56.6535053228449],
[750,56.5028784015711],
[751,56.3496504156406],
[752,56.1938826542047],
[753,56.035637422291],
[754,55.8749780158826],
[755,55.7119686965998],
[756,55.546674665997],
[757,55.3791620394824],
[758,55.2094978198732],
[759,55.0377498705952],
[760,54.8639868885379],
[761,54.6882783765776],
[762,54.5106946157762],
[763,54.3313066372703],
[764,54.1501861938594],
[765,53.9674057313061],
[766,53.7830383593583],
[767,53.5971578225066],
[768,53.4098384704873],
[769,53.2211552285438],
[770,53.031183567457],
[771,52.8399994733584],
[772,52.6476794173367],
[773,52.45430032485],
[774,52.2599395449569],
[775,52.0646748193779],
[776,51.8685842513998],
[777,51.6717462746353],
[778,51.4742396216506],
[779,51.2761432924735],
[780,51.0775365229944],
[781,50.8784987532731],
[782,50.6791095957636],
[783,50.4794488034705],
[784,50.2795962380486],
[785,50.0796318378593],
[786,49.8796355859967],
[787,49.6796874782948],
[788,49.4798674913308],
[789,49.2802555504353],
[790,49.0809314977231],
[791,48.8819750601578],
[792,48.6834658176616],
[793,48.4854831712848],
[794,48.2881063114462],
[795,48.0914141862581],
[796,47.895485469948],
[797,47.70039853139],
[798,47.5062314027586],
[799,47.3130617483163],
[800,47.1209668333493],
[801,46.9300234932624],
[802,46.7403081028456],
[803,46.5518965457258],
[804,46.3648641840136],
[805,46.1792858281599],
[806,45.9952357070328],
[807,45.8127874382267],
[808,45.6320139986166],
[809,45.452987695168],
[810,45.2757801360153],
[811,45.1004622018194],
[812,44.9271040174166],
[813,44.755774923769],
[814,44.5865434502298],
[815,44.4194772871322],
[816,44.2546432587137],
[817,44.0921072963879],
[818,43.9319344123728],
[819,43.7741886736862],
[820,43.6189331765205],
[821,43.4662300210043],
[822,43.3161402863641],
[823,43.1687240064923],
[824,43.0240401459355],
[825,42.8821465763087],
[826,42.743100053148],
[827,42.6069561932086],
[828,42.4737694522194],
[829,42.3435931031008],
[830,42.216479214657],
[831,42.0924786307484],
[832,41.9716409499553],
[833,41.8540145057388],
[834,41.7396463471084],
[835,41.6285822198025],
[836,41.5208665479913],
[837,41.4165424165073],
[838,41.3156515536121],
[839,41.2182343143057],
[840,41.1243296641849],
[841,41.0339751638578],
[842,40.9472069539197],
[843,40.8640597404977],
[844,40.7845667813687],
[845,40.7087598726563],
[846,40.6366693361132],
[847,40.568324006993],
[848,40.503751222516],
[849,40.442976810935],
[850,40.3860250812044],
[851,40.3329188132566],
[852,40.2836792488909],
[853,40.2383260832764],
[854,40.1968774570747],
[855,40.1593499491835],
[856,40.1257585701058],
[857,40.0961167559452],
[858,40.0704363630323],
[859,40.0487276631817],
[860,40.030999339584],
[861,40.0172584833322],
[862,40.0075105905856],
[863,40.0017595603714],
[864,40.000007693025],
[865,40.0022556892698],
[866,40.0085026499375],
[867,40.0187460763271],
[868,40.0329818712044],
[869,40.0512043404415],
[870,40.0734061952936],
[871,40.0995785553148],
[872,40.1297109519099],
[873,40.1637913325222],
[874,40.2018060654538],
[875,40.2437399453184],
[876,40.2895761991231],
[877,40.3392964929775],
[878,40.3928809394271],
[879,40.4503081054078],
[880,40.5115550208187],
[881,40.5765971877104],
[882,40.6454085900833],
[883,40.717961704294],
[884,40.7942275100641],
[885,40.8741755020881],
[886,40.9577737022353],
[887,41.0449886723402],
[888,41.1357855275776],
[889,41.230127950416],
[890,41.3279782051441],
[891,41.4292971529648],
[892,41.5340442676498],
[893,41.6421776517499],
[894,41.753654053353],
[895,41.8684288833851],
[896,41.9864562334443],
[897,42.1076888941642],
[898,42.2320783740971],
[899,42.3595749191095],
[900,42.4901275322832],
[901,42.6236839943137],
[902,42.7601908843969],
[903,42.8995936015969],
[904,43.0418363866854],
[905,43.186862344445],
[906,43.3346134664261],
[907,43.48503065415],
[908,43.6380537427472],
[909,43.7936215250225],
[910,43.9516717759371],
[911,44.1121412774981],
[912,44.2749658440443],
[913,44.4400803479202],
[914,44.6074187455256],
[915,44.7769141037326],
[916,44.948498626658],
[917,45.1221036827802],
[918,45.2976598323916],
[919,45.475096855373],
[920,45.654343779281],
[921,45.835328907736],
[922,46.0179798490997],
[923,46.2022235454308],
[924,46.3879863017074],
[925,46.5751938153038],
[926,46.7637712057106],
[927,46.953643044486],
[928,47.144733385426],
[929,47.3369657949422],
[930,47.5302633826337],
[931,47.7245488320428],
[932,47.9197444315802],
[933,48.1157721056085],
[934,48.3125534456718],
[935,48.510009741858],
[936,48.7080620142811],
[937,48.9066310446728],
[938,49.1056374080687],
[939,49.3050015045767],
[940,49.5046435912163],
[941,49.7044838138147],
[942,49.9044422389475],
[943,50.1044388859106],
[944,50.3043937587118],
[945,50.5042268780681],
[946,50.7038583133961],
[947,50.9032082147834],
[948,51.1021968449273],
[949,51.3007446110291],
[950,51.4987720966295],
[951,51.6962000933746],
[952,51.892949632698],
[953,52.0889420174074],
[954,52.284098853162],
[955,52.4783420798296],
[956,52.6715940027093],
[957,52.8637773236087],
[958,53.0548151717619],
[959,53.2446311345768],
[960,53.4331492881989],
[961,53.6202942278805],
[962,53.8059910981409],
[963,53.9901656227079],
[964,54.1727441342273],
[965,54.3536536037289],
[966,54.5328216698369],
[967,54.7101766677138],
[968,54.8856476577251],
[969,55.0591644538145],
[970,55.2306576515769],
[971,55.4000586560199],
[972,55.5672997090003],
[973,55.7323139163268],
[974,55.8950352745166],
[975,56.055398697196],
[976,56.213340041134],
[977,56.3687961318991],
[978,56.5217047891276],
[979,56.6720048513953],
[980,56.8196362006813],
[981,56.9645397864143],
[982,57.1066576490921],
[983,57.2459329434644],
[984,57.3823099612704],
[985,57.5157341535214],
[986,57.6461521523195],
[987,57.773511792204],
[988,57.897762131017],
[989,58.0188534702798],
[990,58.136737375071],
[991,58.2513666934006],
[992,58.3626955750696],
[993,58.4706794900097],
[994,58.5752752460946],
[995,58.6764410064166],
[996,58.7741363060204],
[997,58.8683220680887],
[998,58.9589606195725],
[999,59.0460157062596],
[1000,59.1294525072762]
]

class Aggregator:
    def __init__(self, posixstart, posixstop):
        self.data_null = None
        self.date_start = posixstart  # should be POSIX values
        self.date_stop = posixstop  # should be POSIX values
        self.data_values = []

    def get_data_avg(self):
        # return the median value of the data set. If the set is empty, return a null
        if len(self.data_values) > 0:
            val_avg = round(mean(self.data_values), 4)
        else:
            val_avg = self.data_null
        return val_avg

    def get_data_median(self):
        # return the median value of the data set. If the set is empty, return a null
        if len(self.data_values) > 0:
            val_median = round(median(self.data_values), 4)
        else:
            val_median = self.data_null
        return val_median

    def get_avg_posix(self):
        avg_time = round((self.date_start + self.date_stop) / 2, 4)
        return avg_time

# This function performs aggregation using the Aggregator class
def aggregate_data(windowsize, querydata):
    # windowsize needs to be at least 1
    # PASS 1 - Set up the array
    print("PASS 1 - Setting up aggregating array")
    aggregate_array = []
    date_start = 0
    for i in range(0, len(querydata), windowsize):
        date_end = querydata[i][0]
        d = Aggregator(date_start, date_end)
        aggregate_array.append(d)
        date_start = date_end

    # PASS 2 - generate the lookup array to speed up data placement
    print("PASS 2 - Generating lookup dict")
    lookup = {}
    j = 0
    for i in range(0, len(querydata)):
        key = (querydata[i][0])
        value = (j)
        lookup[key] = value
        if i % windowsize == 0:
            j = j + 1

    # PASS 3 - add the data into the correct aggregate object based on datetime
    print("PASS 3 - Adding data to aggregating array")
    for i in range(0, len(querydata)):
        # if i % 1000 == 0:
        #     print(f"{i} / {len(result_7d)}")
        datetime = querydata[i][0]
        data = querydata[i][1]
        agg_index = lookup[datetime]
        aggregate_array[agg_index - 1].data_values.append(data)

    # PASS 4 - Use aggregator class functions to create plotting data
    print("PASS 4 - Create and return plotting array [posixdatetime, averagedata]")
    plotting_data = []
    for item in aggregate_array:
        d = [item.get_avg_posix(), item.get_data_avg()]
        plotting_data.append(d)

    return plotting_data